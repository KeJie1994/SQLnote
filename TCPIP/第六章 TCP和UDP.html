<html>
<head>
  <title>第六章 TCP和UDP</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1008"/>
<h1>第六章 TCP和UDP</h1>

<div>
<span><div>第六章 TCP和UDP</div><div><br/></div><div>1.传输层的作用</div><div>（1）定义：传输层必须指出这个具体的程序，为了实现这一功能，使用端口号这样一种识别码。根据端口号就可以识别在传输层上一层的应用层要进行处理的具体程序</div><div><br/></div><div>（2）通信处理：</div><div><img src="第六章 TCP和UDP_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>（3）TCP和UDP</div><div>TCP：面向连接的、可靠的流程协议。实现“顺序控制”和“重发控制”机制，还具有“流控制（流量控制）”、“拥塞控制”、提高网络利用率等众多功能。</div><div>UDP：不具有可靠性的数据报协议，细微的处理他会交给上层的应用去完成。有时会根据应用的需求重发处理。</div><div><br/></div><div>（4）套接字</div><div>应用使用TCP和UDP时，会用到操作系统提供的类库。</div><div>使用TCP和UDP通信时，又会广泛使用到套接字的API。</div><div><img src="第六章 TCP和UDP_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>2.端口号</div><div>（1）定义：用来识别同一台计算机进行通信的不同应用程序，也被称为程序地址</div><div><br/></div><div>（2）通过IP地址、端口号、协议号进行通信识别</div><div><img src="第六章 TCP和UDP_files/Image [2].png" type="image/png" data-filename="Image.png" width="608"/></div><div><br/></div><div>（3）端口号确定</div><div>（a）标准既定的端口号：也叫静态方法，指每个应用程序都有其指定的端口号，每个端口号都有其对于的使用目的。（HTTP,TELENT,FTP等协议中使用的端口号为固定的）</div><div>（b）时序分配法：服务器有必要监听端口号，但是接受接受服务器的客户端没必要确定端口号。（交给操作系统分配，为每个应用程序分配互不冲突的端口号）范围为：49152~65535</div><div><br/></div><div>（4）端口号协议：</div><div><img src="第六章 TCP和UDP_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>3.UDP（User Datagram Protocol）</div><div><img src="第六章 TCP和UDP_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><img src="第六章 TCP和UDP_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>4TCP <span style="font-size: 13px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: arial; font-variant-caps: normal; font-variant-ligatures: normal;">(Transmission Control Protocol）</span></div><div><img src="第六章 TCP和UDP_files/Image [6].png" type="image/png" data-filename="Image.png" width="659"/></div><div><img src="第六章 TCP和UDP_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>（1）特点和目的</div><div>        TCP通过检验和、序列号、确认应答、重发控制、连接管理以及窗口控制等机制实现可靠性传输</div><div><br/></div><div>（2）通过序列号与确认应答提高可靠性</div><div>在TCP中，当发送端的数据到大接收主机时，接收端主机会返回一个已收到消息的通知，这个消息叫做确认应答ACK（Positive Acknowled-gememt）</div><div>序列号是按顺序给发送数据的每一个字节都标上号码的额编号。接收端查询接收数据TCP首部中的序列号和数据的长度，将主机下一步应该接收的序号作为确认应答返送回去。</div><div>通过序列号和确认应答号，TCP可以实现可靠传输</div><div><img src="第六章 TCP和UDP_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>（3）重发超时</div><div>将往返时间和偏差相加，大一点的值。</div><div><img src="第六章 TCP和UDP_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><img src="第六章 TCP和UDP_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>（4）连接管理</div><div>面向连接是值在数据通信开始之前先做好通信两端之间的准备工作</div><div><br/></div><div>一个连接的建立与断开，正常过程至少需要来回发送7个包才能完成</div><div><br/></div><div><img src="第六章 TCP和UDP_files/Image [11].png" type="image/png" data-filename="Image.png"/><img src="第六章 TCP和UDP_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div><span style="color: rgb(50, 62, 50); font-family: simsun; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(235, 235, 235); word-wrap: normal; word-break: normal; line-height: 18px;">SYN(synchronous建立联机)</span></div><div><span style="color: rgb(50, 62, 50); font-family: simsun; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(235, 235, 235); word-wrap: normal; word-break: normal; line-height: 18px;">ACK(acknowledgement 确认)</span></div><div><span style="color: rgb(50, 62, 50); font-family: simsun; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(235, 235, 235);">FIN(finish结束)</span></div><div>(5)TCP以段为单位发送数据</div><div><img src="第六章 TCP和UDP_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><img src="第六章 TCP和UDP_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>（6）利用窗口控制提高速度</div><div><img src="第六章 TCP和UDP_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>窗口大小就是指无需等待确认应答而可以继续发送数据的最大值。上图中窗口大小为4个段。</div><div>这个机制实现；额使用大量的缓冲区，通过对多个段同时进行确认应答的功能</div><div><br/></div><div>收到确认应答的情况下，将窗口滑动到确认应答中的序列号的位置，这样可以顺序将多个端同时发送提高通信性能，这种机制被称为滑动窗口机制。</div><div><br/></div><div><img src="第六章 TCP和UDP_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>（7）窗口控制和重发控制</div><div><br/></div><div><img src="第六章 TCP和UDP_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div><img src="第六章 TCP和UDP_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>（8）流控制</div><div>接收端主动向发送端主机通知自己可以接收数据的大小，于是发送端会发送不超过这个限度的数据，这大小限度被称做窗口大小</div><div><img src="第六章 TCP和UDP_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>（9）拥塞控制</div><div>为了防止网络出现拥堵，在通信一开始就会通过一个叫做慢启动的算法得出的数值，对发送数据量进行控制。</div><div><br/></div><div><img src="第六章 TCP和UDP_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div><img src="第六章 TCP和UDP_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div>（10）提高网络利用率的规范</div><div>（a）Nagle算法</div><div>满足下列任一条件才能发送数据，否则，等待一段时间以后再进行数据发送</div><div>         1.已发送的数据都已收到确认应答时</div><div>         2.可以发送最大段长度（MSS）数据</div><div>（b）延迟确认应答</div><div><img src="第六章 TCP和UDP_files/Image [22].png" type="image/png" data-filename="Image.png"/></div><div><img src="第六章 TCP和UDP_files/Image [23].png" type="image/png" data-filename="Image.png"/></div><div>（c）携带应答</div><div>TCP确认应答和回执数据可以通过一个包发送，这个方法叫做捎带应答</div><div><img src="第六章 TCP和UDP_files/Image [24].png" type="image/png" data-filename="Image.png"/></div><div><br/></div></span>
</div></body></html> 