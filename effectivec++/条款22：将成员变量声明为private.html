<html>
<head>
  <title>条款22：将成员变量声明为private</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="480"/>
<h1>条款22：将成员变量声明为private</h1>

<div>
<span><div><span style="font-size: 14pt;">条款22：将成员变量声明为private</span></div><div><br/></div><div>1.语法一致性：如果成员变量不是public，客服访问该成员的唯一方法就是通过成员函数。列如：object.price( )而不是object.price</div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;"><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">2.还有一个理由：使用函数可以让你对成员变量的处理有更加精确的控制。</span>如果成员变量为public，那么每个人都能读和写，但是如果通过函数读或写其值，那么就能实现“不准访问”、“只读访问”以及“读写访问”，甚至实现“惟写访问”</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>class AccessLevels</div><div>{</div><div>public:</div><div>    ...</div><div>    int getReadongly()const {return readonly;}</div><div>    void setReadWrite(int value){readWrite=value;}</div><div>    int getReadWrite()const{return readWrite;}</div><div>    void setWriteOnly(int value){writeOnly=value;}    </div><div>private:</div><div>    int noAccess;//无任何读写操作</div><div>    int readOnly;//只读</div><div>    int readWrite;//读写</div><div>    int writeOnly;//只写</div><div>}</div></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">3.封装：如果通过函数访问成员变量，日后可以用某个计算替换这个变量，这时class的客户却不知道内部实现已经变化。</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">protected成员的封装貌似高于public，但是事实并非如此，修改protected成员变量，多少derived类需要修改或多少使用derived对象的客户代码需要修改。</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">（1）切记将成员变量声明为private，这可赋予客户访问数据的一致性，可细微划分访问控制，允许约束条件获得保证，并提供class作者以充分的实现弹性</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">（2）protected并不比public更具有封装性</span></div><div><br/></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;"><font style="font-size: 14pt;">条款23：宁以noe-member,non-friend替换member函数</font></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;"><font style="font-size: 14pt;"><br/></font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>class WebBrowser</div><div>{</div><div>public:</div><div>    ...</div><div>    void clearEverying()</div><div>    {</div><div>        clearCash();</div><div>        clearHistory();</div><div>        removeCookies();</div><div>    }</div><div>}</div><div><br/></div><div>//另一种方法利用non-member函数调用member函数</div><div>void clearBrowser(WebBrowser&amp; wb)</div><div>{</div><div>    wb.clearCash();</div><div>    wb.clearHistory();</div><div>    wb.removeCookies();</div><div>}</div></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">面向对象思想要求，数据尽可能被封装，member函数clearEverything带来的封装性比non-member函数clearBrowser低。提供non-member函数，对class相关机能有较大包裹弹性（packaging flexibility），因此带来了较低的编译相依度，增加了class的可延展性。</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">在一个member函数和一个non-member、non-friend函数之间做抉择，如果两者提供相同的机能，显然后者提供了更大的封装，这个就是上面选择clearBrowser函数的原因。</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">在封装这点上，需要注意两点。1、这个论述只适用于non-member、non-friend函数。2、因为封装，让函数成为class的non-member函数，但这并不意味着它不可以是另一个class的member函数。</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">在C++中，实现上述功能，比较自然的做法是把clearBrowser函数和WebBrowser类放到一个命名空间内：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>namespace WebBrowseStuff</div><div>{</div><div>    class WebBrowser{...};</div><div>    void clearBrowser(WebBrowser&amp; we};</div><div>}</div></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">namespace可以跨越多个源码文件，class不能。像clearBrowser这样的函数只是为了提供便利，他是non-member,non-friend,没有对</span><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 10pt; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">webBrowser的特殊访问权限。一个像webBrowser这样的class可能拥有大量的便利函数，例如某些与书签相关的，某些与打印相关的，某些与cookie相关的....客户通常使用其中的一些。在编码时通常分离它们， <span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">将书签相关便利函数声明于一个头文件，将cookie相关函数声明于另一个头文件，再将打印相关函数声明到第三个头文件……</span></span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div style="color: rgb(51, 51, 51);"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 130, 0); background-color: rgb(255, 255, 255); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//头文件webbrowser.h，这个头文件针对class WebBrowser自身及WebBrowser核心机能</span><span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 0, 0); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></span></div><div style="color: rgb(51, 51, 51);">namespace WebBrowserStuff</div><div style="color: rgb(51, 51, 51);">{</div><div style="color: rgb(51, 51, 51);"><div>    class WebBrowser{...}; <span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 130, 0); background-color: rgb(255, 255, 255); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//核心机能</span><span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 0, 0); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></div></div><div style="color: rgb(51, 51, 51);"><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 0, 0); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">    ... <span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 130, 0); background-color: rgb(248, 248, 248); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//non-member函数</span><span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 0, 0); background-color: rgb(248, 248, 248); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></span></div></div><div style="color: rgb(51, 51, 51);">}</div><div style="color: rgb(51, 51, 51);"><br/></div><div style="color: rgb(51, 51, 51);"><span style="color: rgb(0, 130, 0); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248);">//头文件webbrowserbookmarks.h</span></div><div><span style="font-family: Consolas; font-size: 9pt;"><font color="#000000">namespace WebBrowserStuff</font></span></div><div><span style="font-family: Consolas; font-size: 9pt;"><font color="#000000">{</font></span></div><div><span style="font-family: Consolas; font-size: 9pt;"><font color="#000000">    ... <span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 130, 0); background-color: rgb(248, 248, 248); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//与书签相关的便利函数</span><span style="box-sizing: border-box; outline: 0px; word-break: break-all; border: none; color: rgb(0, 0, 0); background-color: rgb(248, 248, 248); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">  </span></font></span></div><div><span style="font-family: Consolas; font-size: 9pt;"><font color="#000000">}</font></span></div><div><br/></div><div><font color="#328712">//头文件webbrowsercookies.h  </font></div><div><span style="font-family: Consolas; font-size: 9pt; color: rgb(0, 0, 0);">namespace WebBrowserStuff</span></div><div><span style="font-family: Consolas; font-size: 9pt; color: rgb(0, 0, 0);">{</span></div><div><span style="font-family: Consolas; font-size: 9pt; color: rgb(0, 0, 0);">    ... <span style="color: rgb(0, 130, 0); font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248);">//与cookie相关的便利函数</span></span><span style="font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; color: rgb(0, 0, 0); box-sizing: border-box; outline: 0px; word-break: break-all; border: none; background-color: rgb(248, 248, 248); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></div><div><span style="font-family: Consolas; font-size: 9pt; color: rgb(0, 0, 0);">}</span></div><div><br/></div><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">这也正是C++标准库的组织方式。标准库有数十个头文件（&lt;vector&gt;,&lt;algorithm&gt;,&lt;memroy&gt;等等），每个头文件声明std的某些机能。如果客户想使用vector相关机能，只需要#include&lt;vector&gt;即可。这也允许客户只对他们所用的那一小部分形成编译相依（条款31，其中讨论降低编译依赖性的其他做法）。</span></div><div><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">将所有便利函数放到多个文件夹但隶属同一个命名空间，意味着客户可以轻松扩展这一组便利函数，他们要做的就是往命名空间添加更多non-member函数和non-friend函数，这也是class无法做到的。当然客户可以继承类来扩展出新类，但是derived class无法访问base class中封装的private成员，因此扩展的机能拥有的只是次级身份。</span></div><div><br/></div><div><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">(1)用non-member,non-friend函数替换member函数，这样可以增加封装性，包裹弹性和机能扩充性。</span></div></div><div><br/></div></span>
</div></body></html> 