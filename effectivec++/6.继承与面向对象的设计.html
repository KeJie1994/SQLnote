<html>
<head>
  <title>6.继承与面向对象的设计</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="496"/>
<h1>6.继承与面向对象的设计</h1>

<div>
<span><div><span style="font-size: 14pt;">6.继承与面向对象的设计</span></div><div><br/></div><div><span style="font-size: 14pt;">条款32：确定你的public继承塑模出is-a关系</span></div><div><br/></div><div>通俗的说：子类可以扩展父类的功能，但不能改变父类原有的功能</div><div>例：</div><div>1.鸟会飞，企鹅不会飞，不是is-a功能</div><div>2.正方形是特殊的长方形，对边长增加这个成员函数功能并不成立，不是is-a功能</div><div><br/></div><div>（1）“public继承”意味is-a，适用于base classes身上的每一件事情一定适用于derived classes身上，因为每一个derived class对象本身也是一个base class；</div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;">条款33：避免遮掩继承而来的函数</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>class Base</div><div><span style="background-color: transparent;">{</span></div><div><span style="background-color: transparent;">private:</span></div><div><span style="background-color: transparent;"><span>    int x;</span><br/></span></div><div><span style="background-color: transparent;"><span>public: </span></span></div><div><span style="background-color: transparent;"><span><span>    virtual void mf1( )=0;</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    virtual void mf1(int);</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    virtual void mf2( );</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    void mf3( );</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    void mf3(double);</span><br/></span></span></div><div><span style="background-color: transparent;">}</span></div><div><span style="background-color: transparent;"><br/></span></div><div><span style="background-color: transparent;">class Derived:public Base</span></div><div><span style="background-color: transparent;">{</span></div><div><span style="background-color: transparent;">public:</span></div><div><span style="background-color: transparent;"><span>    using Base::mf1;</span><br/></span></div><div><span style="background-color: transparent;"><span><span>    using Base::mf2;</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    virtual void mf1( );</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    virtual mf3( );</span><br/></span></span></div><div><span style="background-color: transparent;"><span><span>    virtual mf4( ):</span><br/></span></span></div><div><span style="background-color: transparent;">}</span></div><div><span style="background-color: transparent;"><br/></span></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(246, 248, 250);">Derived d;</span> <span style="box-sizing: border-box; outline: 0px; color: rgb(0, 0, 136); word-break: break-all; font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">int</span> <span style="color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(246, 248, 250);">x; d.mf1();</span><span style="box-sizing: border-box; outline: 0px; color: rgb(136, 0, 0); word-break: break-all; font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//正确，调用Derived::mf1</span><span style="font-family: Monaco; color: rgb(51, 51, 51);"> </span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(246, 248, 250);">d.mf1(x);</span><span style="box-sizing: border-box; outline: 0px; color: rgb(136, 0, 0); word-break: break-all; font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//调用Base::mf1</span><span style="font-family: Monaco; color: rgb(51, 51, 51);"> </span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(246, 248, 250);">d.mf2();</span><span style="box-sizing: border-box; outline: 0px; color: rgb(136, 0, 0); word-break: break-all; font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//正确，调用Base::mf2</span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(246, 248, 250);">d.mf3();</span><span style="box-sizing: border-box; outline: 0px; color: rgb(136, 0, 0); word-break: break-all; font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//正确，调用Derived::mf3</span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(246, 248, 250);">d.mf3(x);</span><span style="box-sizing: border-box; outline: 0px; color: rgb(136, 0, 0); word-break: break-all; font-family: Consolas, Inconsolata, Courier, monospace; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//调用Base::mf3</span></font></div></div><div><br/></div><div><span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font style="font-size: 10pt;">如果想要private继承Base，而Derived唯一想继承的是时Base内mf1无参数的那个版本，using声明在这派不上用场，因为using声明会使继承而来的某个名称所有函数在derived class都可以见。这样的实现需要一个不同的技术，一个简单的转交函数（forwarding function）:</font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>class Base</div><div>{</div><div>public:</div><div><span>    virtual void mf1( );</span><br/></div><div><span><span>    virtual void mf1(int );</span><br/></span></div><div>}</div><div>class Derived:private Base</div><div>{</div><div>public:</div><div><span>    virtual void mf1()</span><br/></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    Base::mf1( );//转交函数，隐式成为inline</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div></div><div>（1）derived classes内的名称会遮掩base classes内的名称，在public继承下重来没有人希望如此</div><div>（2）为了让被遮掩的名称再见天日，可使用using声明式或转交函数</div></span>
</div></body></html> 