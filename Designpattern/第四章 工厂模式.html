<html>
<head>
  <title>第四章 工厂模式</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1448"/>
<h1>第四章 工厂模式</h1>

<div>
<span><div>第四章 工厂模式</div><div><br/></div><div>1. <span style="font-size: 13.92px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Arial; font-variant-caps: normal; font-variant-ligatures: normal;">我们在前边提到一个原则就是“面向接口而不要面向实现编程”，但是我们一直在使用Duck duck = new MallardDuck()这样的模式，后边的new语句却违反了这个原则。工厂方法就可以解决这个问题，它用来封装对象的创建。</span></div><div><br/></div><div><span style="font-size: 13.92px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Arial; font-variant-caps: normal; font-variant-ligatures: normal;">2.一个披萨店要制作各种披萨，甚至还要开分店，其中涉及到订购披萨的步骤。</span></div><div><span style="font-size: 13.92px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Arial; font-variant-caps: normal; font-variant-ligatures: normal;">  把orderPizza的中关于制作pizza的部分单独提取到一个类中。</span></div><div><span style="font-size: 13.92px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Arial; font-variant-caps: normal; font-variant-ligatures: normal;">  </span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>public class PizzaStore</div><div>{</div><div>    SimplePizzaFactory factory;</div><div>    public PizzaStore(PizzaStore factory)</div><div>    {</div><div>        this.factory=factory;</div><div>    }</div><div>    public Pizza orderPizza(String type)</div><div>    {</div><div>        Pizza pizza;</div><div>        pizza=factory.createPizza(type);</div><div><br/></div><div>        pizza.prepare();</div><div>        pizza.bake();</div><div>        pizza.cut();</div><div>        pizza.box();</div><div>        return pizza;</div><div>    }</div><div>}</div><div><br/></div><div>//制作pizza的方式，简单工厂方式</div><div>public class SimplePizzaFactory</div><div>{</div><div>    public Pizza createPizza(String type)</div><div>    {</div><div>        Pizza pizza=null;</div><div>        if(type.equals(&quot;cheese&quot;))</div><div>            pizza=new ChessPizza();</div><div>        else if(type.equals(&quot;pepperoni&quot;))</div><div>            pizza=new Pepperoni();</div><div>        else if(type.equals(&quot;clam&quot;))</div><div>            pizza=new Clam();</div><div>        else if(type.equals(&quot;veggie&quot;)</div><div>            pizza=new Veggie():</div><div>        </div><div>        return pizza;</div><div>    }</div><div>}</div></div><div><br/></div><div>一个pizza商店在制作pizza时刻专门的供应商可以提供。orderPizza实现，这个单独形成的类可以提供更多的服务（比如同时经营连锁店或者送货上门服务），这就是简单工厂模式，简单工厂模式并不等价于工厂模式。</div><div><br/></div><div><br/></div><div>3.工厂方法：加盟店要有自己的风味又要按照总店的一些要求。</div><div>可以重新设计PizzaStore类，将createPizza方法从SimplePizzaFactory中移出来，加盟店必须完成这个方法自定义自己的Pizza，而orderPizza继承过来不变</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>public abstract class PizzaStore//抽象工厂类，提供了一个抽象的工厂方法供子类实现这个方法，注意这是面向接口编程</div><div>{</div><div>    abstract Pizza createPizza(String item);//工厂方法</div><div>    public Pizza orderPizza(String type)</div><div>    {</div><div>        Pizza pizza=createPizza(String type);//这里的createPizza方法是抽象方法，具体由子类完成--这就是工厂方法的特点-让类把实例化推迟到子类，因为                                                        orderPizza不知道哪个实际子类将制作pizza，具体由XXXPizzaStore来决定。</div><div>        System.out.println(&quot;Makeing a &quot;+pizza.getName());</div><div>        <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">pizza.prepare();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">               pizza.bake();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">               pizza.cut();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">               pizza.box();</span></div><div><br/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">              return pizza;</span></div><div>    }</div><div>}</div><div><br/></div><div>//开一家芝加哥分店</div><div>public class ChicagoPizzaStore extends PizzaStore</div><div>{</div><div>    Pizza createPizza(String item)</div><div>    {</div><div>        if(item.equals(&quot;cheese&quot;)</div><div>            return new ChicagoStyleCheesePizza();</div><div>        else if(item.equals(&quot;veggie&quot;)</div><div>            return new ChicagoStyleVeggiePizza();</div><div>        else if(item.equals(&quot;clam&quot;)</div><div>            return new ChicagoStyleClamPizza();</div><div>        else if(item.equals(&quot;pepperoni&quot;)</div><div>            return new ChicogoStylePepperoni();</div><div>        else</div><div>            return null;</div><div>    }</div><div>}</div><div><br/></div><div>public abstract class Pizza//这个类被称为抽象产品类，也就是说工厂方法的中的产品都是这个类的子类</div><div>{</div><div>    String name;</div><div>    String dough;</div><div>    String sauce;</div><div>    ArrayList topping=new ArrayList();</div><div>    void prepare()</div><div>    {</div><div>        System.out.println(&quot;Preparing&quot;+name);</div><div>        System.out.println(&quot;Tossing dough&quot;);</div><div>        System.out.println(&quot;Adding sauce...&quot;);</div><div>        System.out.println(&quot;Adding toppings&quot;);</div><div>        for(int i=0;i&lt;topping.size();i++)</div><div>            System.out.println(&quot; &quot;+toppings.get(i));</div><div>    }</div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">       void bake()</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">         {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            System.out.println(&quot;Bake for 25 minutes at 350&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        void cut() </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            System.out.println(&quot;Cutting the pizza into diagonal slices&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">      void box() </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            System.out.println(&quot;Place pizza in official PizzaStore box&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        public String getName()</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">         {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            return name;</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt;">       </span> <span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt;">}</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        public String toString()</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">         {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            StringBuffer display = new StringBuffer();</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            display.append(&quot;---- &quot; + name + &quot; ----/n&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            display.append(dough + &quot;/n&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            display.append(sauce + &quot;/n&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            for (int i = 0; i &lt; toppings.size(); i++) {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">                display.append((String )toppings.get(i) + &quot;/n&quot;);</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        return display.toString();</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial;color: rgb(0, 0, 0);font-size: 9pt;-en-paragraph:true;">    }</span><span style="font-family: Arial;color: rgb(0, 0, 0);font-size: 9pt;-en-paragraph:true;"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;">}</div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">//定义一个芝加哥风味的pizza</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">public class ChicagoStyleClamPizza extends Pizza</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">{</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    public ChicagoStyleClamPizza()</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">    {</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">       <span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">name = &quot;Chicago Style Clam Pizza&quot;;</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">            dough = &quot;Extra Thick Crust Dough&quot;;</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">            sauce = &quot;Plum Tomato Sauce&quot;;</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></font></div><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">            toppings.add(&quot;Shredded Mozzarella Cheese&quot;);</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></font></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;"><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">            toppings.add(&quot;Frozen Clams from Chesapeake Bay&quot;);</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    }</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">    void cut（）</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    {</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">         <span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">System.out.println(&quot;Cutting the pizza into square slices&quot;);</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    }</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">}</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">//测试</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">public class PizzaTstDrive</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">{</font></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    public static void main()</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    {</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">        PizzaStore chicagoStore=new ChicagoPizzaStore();</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">        Pizza pizza=chicagoStore.orderPizza(&quot;clam&quot;);</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><font style="font-size: 9pt;">    }</font></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="font-size: 9pt;">}</font></div></div><div>工厂方法让类把实例化推迟到子类，第六个原则：要依赖于抽象，不要依赖于具体类。</div><div><br/></div><div>4.抽象工厂模式：针对不同的分店，采用不同的原料，首先我们定义一个产生原料的工厂</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>public interfacle PizzaIngredientFactory//抽象工厂的任务定义一组产品的接口</div><div>{</div><div>   <b> </b> <span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">public Dough createDough();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">        public Sauce createSauce();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">        public Cheese createCheese();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">        public Veggies[] createVeggies();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">        public Pepperoni createPepperoni();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">        public Clams createClam();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> </span></div><div>}</div><div><br/></div><div>//我们根据这一模式建设各地的分工厂</div><div> public class NYPizzaIngredientFactory()</div><div>{</div><div>    public Dough createDough()</div><div>    {</div><div>        return new ThisCrustDough();</div><div>    }</div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        public Sauce createSauce() </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">       {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            return new MarinaraSauce();</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        public Cheese createCheese()</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">         {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">             return new ReggianoCheese();</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">       public Veggies[] createVeggies()  </span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        {</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            Veggies veggies[] = { new Garlic(), new Onion(), new Mushroom(), new RedPepper() };</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            return veggies;</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        public Pepperoni createPepperoni() </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            return new SlicedPepperoni();</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        public Clams createClam() </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        {</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">            return new FreshClams();</span><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;"> </span></div><div><span style="font-family: Arial; color: rgb(0, 0, 0); font-size: 9pt;">        }</span></div><div>}</div><div><br/></div><div>//现在我们做一个Pizza，使用原料原厂提供的原料，这是一个产品抽象类</div><div> public abstract class Pizza</div><div>{</div><div>    String name;</div><div>    Dough dough;</div><div>    Sauce sauce;</div><div>    Veggies veggies[];</div><div>    Cheese cheese;</div><div>    Pepperoni pepperoni;</div><div>    Clams clam;</div><div><br/></div><div>    abstract void prepare();//这需要具体产品类实现，表示使用一族产品;</div><div>    </div><div>    void bake()</div><div>    {</div><div>        System.out.println(&quot;Bake for 25 minutes at 350&quot;);</div><div>    }</div><div>    void cut()</div><div>    {</div><div>        System.out.println(&quot;Cutting the pizza into doagonal slices&quot;);</div><div>    }</div><div>    void box()</div><div>    {</div><div>        System.out.println(&quot;Place pizza in official PizzaStore box&quot;);</div><div>    }</div><div>    void setName(String name)</div><div>    {</div><div>        this.name=name;</div><div>    }</div><div>    String getNmae()</div><div>    {</div><div>        return name;</div><div>    }</div><div>}</div><div><br/></div><div>//构建具体的Pizza（具体产品类）</div><div>public class CheesePizza extends Pizza</div><div>{</div><div>    PizzaIngredientFactory ingredientFactory;</div><div>    Public CheesePizza(PizzaIngredientFactory ingredientFactory)</div><div>    {</div><div>        this.<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ingredientFactory=<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ingredientFactory;</span></span></div><div>    }</div><div>    void prepare()</div><div>    {</div><div>        System.out.println(&quot;Preparing&quot;+name);</div><div><span>    </span><span>    dough=<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ingredientFactory.dough;</span></span><br/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span>    </span><span>    </span><span>    </span><span>   sauce=<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ingredientFactory.createSauce();</span></span><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span>    </span><span>    </span><span>    </span><span>   cheese=<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ingredientFactory.createCheese();</span></span><br/></span></span></div><div>    }</div><div>}</div><div><br/></div><div><br/></div><div>//抽象工厂类</div><div>public abstract class PizzaStore</div><div>{</div><div><span>    protected abstract Pizza createPizza(String item);</span><br/></div><div><span><span>    public Pizza orderPizza(String type)</span><br/></span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    Pizza pizza=createPizza(type);</span><br/></span></div><div><span><span>    </span><span>    System.out.println(&quot;Making a&quot;+pizza.getName()）;</span><br/></span></div><div><span><span>    </span><span>    pizza.prepare();</span><br/></span></div><div><span><span>    </span><span>    pizza.bake();</span><br/></span></div><div><span><span>    </span><span>    pizza.cut();</span><br/></span></div><div><span><span>    </span><span>    pizza.box();</span><br/></span></div><div><span><span>    </span><span>    return pizza;</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div><div>//具体的店</div><div>public class NYPizzaStore extends PizzaStore</div><div>{</div><div><span>    protected Pizza createPizza(String item)</span><br/></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    Pizza pizza=null;</span><br/></span></div><div><span><span>    </span><span>    PizzaIngredientFactory ingredientFactory=new NYPizzaIngredientFactory();</span><br/></span></div><div><span><span>    </span><span>    if(item.equals(&quot;cheese&quot;)</span><br/></span></div><div><span><span>    </span><span>    {</span><br/></span></div><div><span><span>    </span><span>    </span><span>    pizza=new CheesePizza(ingredientFactory);</span><br/></span></div><div><span><span>    </span><span>    </span><span>    pizza.setName(&quot;New York Style Cheese Pizza&quot;);</span><br/></span></div><div><span><span>    </span><span>    <span>}</span></span><br/></span></div><div><span><span>    </span><span>    else if(item.equals(&quot;veggie&quot;)</span><br/></span></div><div><span><span>    </span><span>    {</span><br/></span></div><div><span><span>    </span><span>    </span><span>    pizza=new VeggiePizza(ingredientFactory);</span><br/></span></div><div><span><span>    </span><span>    </span><span>    pizza.setName(&quot;New york Veggie Pizza:);</span><br/></span></div><div><span><span>    </span><span>    }</span><br/></span></div><div><span>    </span><span>    <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">else if(item.equals(&quot;veggie&quot;)</span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      <span>    </span>    {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">           <span>    </span>      pizza=new VeggiePizza(ingredientFactory);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                     pizza.setName(&quot;New York Veggie Pizza:);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span>    </span><span>    </span><span>    </span><span>   }</span><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    </span><span>    </span><span>    else if(item.equals(&quot;clam&quot;)</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    </span><span>    </span><span>    {</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  pizza=new ClamPizza(ingredientFactory);</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  pizza.setName(&quot;Net York Clam Pizza“）；</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    </span><span>    </span><span>    }</span><br/></span></span></div><div><span>    </span><span>    </span><span> else if(item.equals(&quot;pepperoni&quot;)</span><br/></div><div><span><span>    </span><span>    </span><span> {</span><br/></span></div><div><span>    </span><span>    </span><span>    pizza=new PeppernoiPPizza(ingredientFactory);</span></div><div><span><span>    </span><span>    </span><span>    pizza.setName(&quot;New York Style Pepperoni Pizza&quot;);</span><br/></span></div><div><span><span>    </span><span>    </span><span> }</span><br/></span></div><div><span>    </span><span>    return pizza;</span><br/></div><div><span><span>    }</span><br/></span></div><div>}</div><div><br/></div><div><br/></div><div>//测试 订购一个pizza</div><div>public class PizzaTestDirve</div><div>{</div><div><span>    public static void main(String[] args)</span><br/></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    PizzaStore nyStore=new NYPizzaStore();</span><br/></span></div><div><span><span>    </span><span>    Pizza pizza=nyStore.orderPizza(&quot;cheese&quot;);</span><br/></span></div><div><span><span>    </span><span>    System.out.println(&quot;Ethan ordered a&quot;+pizza);</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div></div><div>抽象工厂方法提供一个接口(PizzaIngredientFactory)，每个家族成员(NYPizzaIngredientFactory)都负责创建一个具体的产品。</div><div>与工厂方法的区别：工厂方法用的是继承，利用工厂方法创建对象扩展一个类，覆盖它的工厂方法(CreatePizza)</div><div>工厂方法实质在于通过子类创建对象，抽象工厂方法使用的是组合。</div><div>具体的工厂方法创建（工厂方法和抽象工厂方法的联系），这里商店的实现是工厂方法，制作pizza原料采用抽象工厂方法。</div><div><br/></div><div><br/></div><div>5.总结</div><div>简单工厂模式：首先包括一个“抽象产品类”(pizza),产品类继承于此(XXPizza).</div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    还包含一个具体的工厂类（SImplePizzaFctory）所有的产品类都是该类的产品类对象。该方法返回的是“抽象<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>产<span> </span>品类”（Pizza createPizza(String type,Pizza为抽象产品类）;</span><br/></div><div><span>  </span></div><div><span>工厂方法：抽象产品类(Pizza),派生出多个具体的产品类(XXXPizza),和简单工厂模式一样</span></div><div><span>   <span>    </span><span>    </span><span>    </span><span>    还包含一个抽象工厂类(PizzaStore),可以派生出具体工厂类(XXXPizzaStore),和简单工厂模式一样</span></span><br/></div><div><span><span>    </span><span>    </span><span>    </span><span>    </span><span>    与简单工厂相比，工厂方法对工厂类进行了抽象产生了一个抽象工厂类，规定一系列流程(OrderPizza），还将具体<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>产品类创建交给了具体的工厂类(createPizza在XXXPizza中实现）</span><br/></span></div><div><span>抽象工厂方式： <span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">首先，包括一个抽个产品类（本例中为Pizza），该抽象产品类可以派生出多个具体产品类（本例为<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>XXXPizza），在每个具体产品类中以组合的形式将另一个抽象工厂类（本例为PizzaIngredientFactory ）<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>的引用包含进来，完成一群具体产品类的构建（XXXPizza的Prepare方法）。</span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>另外还包含两个抽象工厂类，本例中PizzaStore，可以派生出多个具体工厂类XXXPizzaStore，这个与简<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>单<span> </span>工厂方法中的具体工厂类没有区别，  每个具体工厂类可以创建一个具体产品类的实例<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>（XXXPizza），但是这个具体产品类的实例比较特殊，是利用另一个抽象工厂类PizzaIngredientFactory <span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  </span>的具体工厂类创建的一群具体产品类而构建（XXXPizza的Prepare方法），请注意这个类才是抽象工厂<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>方<span> </span>法的实质。</span></div></span>
</div></body></html> 