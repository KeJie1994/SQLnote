<html>
<head>
  <title>第十章 状态模式</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1464"/>
<h1>第十章 状态模式</h1>

<div>
<span><div>第十章 状态模式</div><div>1</div><div><img src="第十章 状态模式_files/Image.png" type="image/png" data-filename="Image.png" width="526"/></div><div>对这个状态机写了一个有if ..else的状态机程序</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>public class GumballMachine</div><div>{</div><div>    final static int SOLD_OUT=0;</div><div>    final static int NO_QUARTER=1;</div><div>    final static int HAS_QUARTER=2;</div><div>    final static int SOLD=3;</div><div>    int state=SOLD_OUT;</div><div>    int count=0;</div><div>    public GumballMachine(int count)</div><div>    {</div><div>        this.count=count;</div><div>        if(count&gt;0)</div><div>            state=NO_QUARTER;</div><div>    }</div><div>    public void insertQuarter()</div><div>    {</div><div>        if(state==HAS_QUARTER)</div><div>            system.out.println(&quot;you can't insert another quarter&quot;);</div><div>        else if(state==NO_QUARTER)</div><div>        {</div><div>            state=HAS_QUARTER;</div><div>            system.out.println(&quot;you have inserted a quarter&quot;);</div><div>        }</div><div>        else if(state==SOLD_OUT)</div><div>            system.out.println(&quot;the machine is sold out&quot;);</div><div>        else uf(state==SOLD)</div><div>            system.out.println(&quot;please wait,we're already giving you a gumball&quot;);</div><div>    }</div><div>    public void ejectQUarter()</div><div>    {</div><div>        if(state==HAS_QUARTER)</div><div>        {</div><div>            <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"> system.out.println(&quot;quarter returned&quot;);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        state==NO_QUARTER;</span></div><div>        }</div><div>        else if(state==NO_QUARTER)</div><div>            system.out.println(&quot;you haven't insert a quarter&quot;);</div><div>        else if(state==SOLD)</div><div>            system.out.println(&quot;sorry,you have turned the crank&quot;);</div><div>        else if(state==SOLD_OUT)</div><div>            system.out.println(&quot;yun can'i reject,you haven't inserted a quarter yet&quot;);</div><div>    }</div><div>    public void turnCrank()</div><div>    {</div><div>        if(state==SOLD)</div><div>            System.out.println(&quot;Turning twice doesn't get ypu another gumball&quot;);</div><div>        else if(state==SOLD_OUT)</div><div>            System.out.println(&quot;there are no gumballs&quot;);</div><div>        else if(state==HAS_QUARTER)</div><div>        {</div><div>            System.out.println(&quot;you turned...&quot;</div><div>            state==SOLD;</div><div>            dispense();</div><div>        }</div><div>        else if(state==NO_QUARTER)</div><div>            system.out.println(&quot;there is no quarter&quot;);</div><div>    }</div><div>    public void dispense()</div><div>    {</div><div>        if(state==SOLD)</div><div>        {</div><div>            System.out.println(&quot;A gumball come&quot;);</div><div>            count-=1;</div><div>            if(count==0)</div><div>            {</div><div>                System.out.println(&quot;outs of gumballs&quot;);</div><div>                state=SOLD_OUT;</div><div>            }</div><div>            else </div><div>                state=NO_QUARTER;</div><div>        }</div><div>        else if(state==NO_QUARTER)</div><div>            System.out.println(&quot;you need to pay first&quot;);</div><div>        else if(state==SOLD_OUT)</div><div>            Syestem.out.println(&quot;no gumball&quot;);</div><div>        else if(state==HAS_QUARTER)</div><div>            System.out.println(&quot;no gumball dispense&quot;);</div><div>    }</div><div>    public void refill(int numGumballs)</div><div>    {</div><div>        this.count=numGumaballs;</div><div>        state=NO_QUARTER;</div><div>    }</div><div>}</div></div><div><br/></div><div>2.公司要加入新要求：当曲柄被转动时，有几率掉下两颗糖。</div><div>如果加入一个“赢家状态”,每一个状态都要加入一些判断是不是这个状态，不是我们想要的。</div><div>设计一个State接口，在这个接口中，糖果机每一个动作对应一个方法</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">public interface State</span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> {</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">    public void insertQuarter();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">    public void ejectQuarter();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">    public void turnCrank();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">    public void dispense();</span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">}</span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//我们将每个状态实现状态类，将动作委托到状态类中</span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//例如：没有投币的状态</span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">public class NoQuarterState implements State </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">{</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    GumballMachine gumballMachine;</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    public NoQuarterState(GumballMachine gumballMachine) </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"><span>    </span>{</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">        this.gumballMachine = gumballMachine;</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    }</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    public void insertQuarter() </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"><span>    </span>{</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">        System.out.println(&quot;You inserted a quarter&quot;);</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">      </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: bold; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">gumballMachine.setState(gumballMachine.getHasQuarterState());//状态转移</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: bold; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: bold; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    }</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    public void ejectQuarter() </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"><span>    </span>{</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">        System.out.println(&quot;You haven't inserted a quarter&quot;);</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    }</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    public void turnCrank()</span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"><span>    </span> {</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">        System.out.println(&quot;You turned, but there's no quarter&quot;);</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">     }</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    public void dispense()</span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"><span>    </span> {</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">        System.out.println(&quot;You need to pay first&quot;);</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    }</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    public String toString()</span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"><span>    </span> {</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">        return &quot;waiting for quarter&quot;;</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">    }</span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; line-height: 26px;"> </span><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;"> </span></div><div><span style="color: rgb(0, 0, 0); font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">}</span></div><div><br/></div></div><div>3. <span style="color: rgb(0, 0, 0); font-family: Arial; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">我们将这些状态整合到一个类中——糖果机类，在这个类的设计中分为两大部分——对于状态的setter和getter，对于状态方法的封装（委托给当前的类）。另外这样我们就得到一个糖果机了：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">public class GumballMachine</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    State soldOutState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    State noQuarterState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    State hasQuarterState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    State soldState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;">    State state = soldOutState;//当前状态</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    int count = 0;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public GumballMachine(int numberGumballs)</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"><span>    </span> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;">{//开始的时候就用这个糖果机的类创建好各个状态以便后边的时候</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold; line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        soldOutState = new SoldOutState(this);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        noQuarterState = new NoQuarterState(this);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        hasQuarterState = new HasQuarterState(this);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">        soldState = new SoldState(this);</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        this.count = numberGumballs;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">         if (numberGumballs &gt; 0) </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            state = noQuarterState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void insertQuarter() </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        state.insertQuarter();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void ejectQuarter() </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        state.ejectQuarter();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void turnCrank()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        state.turnCrank();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        state.dispense();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    void setState(State state)</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        this.state = state;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    void releaseBall() </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;A gumball comes rolling out the slot...&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        if (count != 0)</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            count = count - 1;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    int getCount() </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return count;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    void refill(int count)</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        this.count = count;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        state = noQuarterState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public State getState()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return state;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public State getSoldOutState()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return soldOutState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public State getNoQuarterState()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return noQuarterState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public State getHasQuarterState()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return hasQuarterState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public State getSoldState()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return soldState;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public String toString()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">      }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">}</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;"><br/></span></div><div style="margin-top: 1em; margin-bottom: 1em;">//测试</div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; word-break: normal; text-size-adjust: auto;">public class GumballMachineTestDrive</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; word-break: normal; text-size-adjust: auto;"> {</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public static void main(String[] args)</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">   {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">        GumballMachine gumballMachine = new GumballMachine(5);</span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">        System.out.println(gumballMachine);</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        gumballMachine.insertQuarter();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">        gumballMachine.turnCrank();</span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">        System.out.println(gumballMachine);</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        gumballMachine.insertQuarter();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        gumballMachine.turnCrank();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        gumballMachine.insertQuarter();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">        gumballMachine.turnCrank();</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(gumballMachine);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">}</span></div></div><div><br/></div><div>4.考虑10%的中奖概率</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">public class WinnerState implements State </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    GumballMachine gumballMachine;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public WinnerState(GumballMachine gumballMachine)</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        this.gumballMachine = gumballMachine;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void insertQuarter() </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;Please wait, we're already giving you a Gumball&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void ejectQuarter()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;Please wait, we're already giving you a Gumball&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void turnCrank()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;Turning again doesn't get you another gumball!&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void dispense() </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;YOU'RE A WINNER! You get two gumballs for your quarter&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        gumballMachine.releaseBall();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        if (gumballMachine.getCount() == 0) </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span><span>    </span>{</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            gumballMachine.setState(gumballMachine.getSoldOutState());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        } else {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            gumballMachine.releaseBall();</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            if (gumballMachine.getCount() &gt; 0) {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">                gumballMachine.setState(gumballMachine.getNoQuarterState());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            } else {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">                System.out.println(&quot;Oops, out of gumballs!&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">                gumballMachine.setState(gumballMachine.getSoldOutState());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public String toString()</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return &quot;despensing two gumballs for your quarter, because YOU'RE A WINNER!&quot;;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">}</span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">我们再加入10%成为赢家的逻辑：</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">public class HasQuarterState implements State</span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"><span>    </span> {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    Random randomWinner = new Random(System.currentTimeMillis());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    GumballMachine gumballMachine;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public HasQuarterState(GumballMachine gumballMachine) {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        this.gumballMachine = gumballMachine;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void insertQuarter() {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;You can't insert another quarter&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void ejectQuarter() {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;Quarter returned&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        gumballMachine.setState(gumballMachine.getNoQuarterState());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void turnCrank() {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;You turned...&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">     </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;">int winner = randomWinner.nextInt(10);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold; line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;">        if ((winner == 0) &amp;&amp; (gumballMachine.getCount() &gt; 1)) {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold; line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); font-weight: bold;"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            gumballMachine.setState(gumballMachine.getWinnerState());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        } else {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">            gumballMachine.setState(gumballMachine.getSoldState());</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">    }</span></div><p style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"></p><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public void dispense() {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        System.out.println(&quot;No gumball dispensed&quot;);</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    public String toString() {</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">        return &quot;waiting for turn of crank&quot;;</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);">    }</span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0); line-height: 26px;"> </span><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);"> </span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Arial; font-size: 9pt; color: rgb(0, 0, 0);-en-paragraph:true;">}</span></div></div><div><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">5.我们给这样的状态机设计一个名字就是“状态模式”——允许对象在内部状态改变时改变它的行为，对象在外边看起来就像是修改了它的类一样。也就是说，里面的逻辑对外是不可见的，但同时实际的状态，或者说参与的逻辑又是高度可扩展的。记得，不要让外界直接接触状态，这样就破坏了面向对象设计的原则。</span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">我们可以拿状态模式与</span><a href="http://blog.csdn.net/gnuhpc/archive/2010/03/09/5360328.aspx" style="text-indent: 0px; color: rgb(255, 153, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto; border-bottom-style: none;">策略模式</a><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">做个对比，前者在内部定了各个逻辑步骤和状态转移，随着程序的进行对外呈现不同的样子，这是对多个条件判断的一种替代方案，而后者则是在一开始由外部主动指定要组合的策略对象是哪些，这是对继承之外的一种替代方案。</span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"> </span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">6.我们可以把这个设计再提升一下：</span></div><div style="margin: 0px; padding: 0px; text-indent: 0px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.92px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;"><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; background-color: rgb(255, 255, 255); word-break: normal; text-size-adjust: auto;">1) 我们可以把State设计为抽象类，将一些方法默认的行为，尤其是出错的行为放入其中，毕竟有些出错提示是颇具有通用性的，可以供子状态去继承。</span></div><div><span style="text-indent: 0px; color: rgb(0, 0, 0); font-family: Arial; font-size: 9pt; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 26px; word-break: normal; text-size-adjust: auto;">2)当我们没有投币时也可以调用转动曲柄的方法，这实际上是不合理的，我们可以通过加入一个布尔类型来屏蔽这一bug。</span></div></span>
</div></body></html> 