<html>
<head>
  <title>设计模式六大原则(5）：迪米特原则</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1492"/>
<h1>设计模式六大原则(5）：迪米特原则</h1>

<div>
<span><div><span style="font-size: 14pt;">设计模式六大原则(5）：迪米特原则</span></div><div><span style="font-size: 14pt;"><br/></span></div><div><font style="font-size: 10pt;">1.定义：一个对象应该对其他对象保持最少的了解</font></div><div><font style="font-size: 10pt;">尽量降低类与类之间的耦合（低耦合，高内聚）</font></div><div><font style="font-size: 10pt;">简单的定义：只与直接的朋友进行通信。（我们称出现在成员变量，方法参数，方法返回值的类为直接朋友，而出现在局部变量中的类不是直接的朋友。也就是说，陌生的类不要以局部变量的形式出现在类的内部。）</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>//举例：一个公司的下属单位有分公司和直属部门，打印下属单元员工的ID。</div><div>//先看违反迪米特法则的设计</div><div>//总公司员工</div><div>class Employee</div><div>{</div><div><span>    private String id;</span><br/></div><div><span><span>    public void SetId(string id)</span><br/></span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    this.id=id;</span><br/></span></div><div><span><span>    }</span><br/></span></div><div><span><span>    public String getId()</span><br/></span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    return id;</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div><div>//分公司</div><div>class SubEmployee</div><div>{</div><div><span>    private String id;</span><br/></div><div><span><span>    public void setID(String id)</span><br/></span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    this.id=id;</span><br/></span></div><div><span><span>    }</span><br/></span></div><div><span><span>    public String getId()</span><br/></span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    return id;</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div><div><br/></div><div>class SubCompanyManager</div><div>{</div><div><span>    public List&lt;SumEmpoyee&gt; getAllEmployee()</span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    List&lt;SubEmployee&gt; getAllEmployee()</span><br/></span></div><div><span><span>    </span><span>    {</span><br/></span></div><div><span>    </span><span>    </span><span>    List&lt;SubEmployee&gt; list=new ArrayList&lt;SubEmployee&gt;();</span></div><div><span><span>    </span><span>    </span><span>    for(int i=0;i&lt;100;i++)</span><br/></span></div><div><span><span>    </span><span>    </span><span>    {</span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><span>    SumEmployee emp=new SubEmplyee();</span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><span>    emp.setID(&quot;分公司&quot;+i);</span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><span>    list.add(emp);</span><br/></span></div><div><span><span>    </span><span>    </span><span>    }</span><br/></span></div><div><span>    </span><span>    </span><span>    return list;</span><br/></div><div><span><span>    </span><span>    }</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div><div>class CompanyManager</div><div>{</div><div><span>    public list&lt;Employee&gt; getAllEmployee()</span><br/></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    List&lt;Employee&gt; list=new ArrayList&lt;Employee&gt;();</span><br/></span></div><div><span><span>    </span><span>    for(int i=0;i&lt;30;i++)</span><br/></span></div><div><span><span>    </span><span>    {</span><br/></span></div><div><span><span>    </span><span>    </span><span>    Employee emp=new Employee();</span><br/></span></div><div><span><span>    </span><span>    </span><span>    emp.setId(&quot;总公司&quot;+i);</span><br/></span></div><div><span><span>    </span><span>    </span><span>    list.add(emp);</span><br/></span></div><div><span><span>    </span><span>    }</span><br/></span></div><div><span>    </span><span>    return list;</span><br/></div><div><span><span>    }</span><br/></span></div><div><span><span>    public void printAllEmployee(SubEmployee sub)</span><br/></span></div><div><span><span>    {</span><br/></span></div><div><span><span>    </span><span>    List&lt;SumEmployee&gt; list1=sub.getAllEmployee();</span><br/></span></div><div><span><span>    </span><span>    for(SubEmployee e:list1)</span><br/></span></div><div><span><span>    </span><span>    </span><span>    System.out.println(e.getId());</span><br/></span></div><div><span><span>    </span><span>    </span><br/></span></div><div><span><span>    </span><span>    List&lt;Employee&gt; list2=this,getAllEmployee();</span><br/></span></div><div><span><span>    </span><span>    for(Employee e:list2)</span><br/></span></div><div><span><span>    </span><span>    </span><span>    System.out.println(e.getId());</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div><div>public class Client</div><div>{</div><div><span>    public static void main(String[] args)</span><br/></div><div><span><span>    {</span><br/></span></div><div><span><span> <span>    </span>   companyManager e=new CompanyManager();</span><br/></span></div><div><span><span>    </span><span>    e.printAllEmployee(new SubCompanyManager()):</span><br/></span></div><div><span><span>    }</span><br/></span></div><div>}</div></div><div><font style="font-size: 10pt;">//SubEmployee类并不是CompanyManager类的直接朋友，从逻辑上讲总公司与他的分公司耦合就行了，与分公司的员工没有任何联系，增加了不必要的耦合。</font></div><div><font style="font-size: 10pt;">修改后为</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">class SubCompanyManager</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    public List&lt;SumEmpoyee&gt; getAllEmployee()</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        List&lt;SubEmployee&gt; getAllEmployee()</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            List&lt;SubEmployee&gt; list=new ArrayList&lt;SubEmployee&gt;();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            for(int i=0;i&lt;100;i++)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                SumEmployee emp=new SubEmplyee();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                emp.setID(&quot;分公司&quot;+i);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                list.add(emp);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            return list;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span>    public void printEmployee()</span><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    {</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    List&lt;SubEmployee&gt; list=this,getAllEmplyee();</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    for(SubEmployee e:list)</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    </span><span>    </span><span>    System.out.println(e.getId());</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span><span>    }</span><br/></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">class CompanyManager</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    public list&lt;Employee&gt; getAllEmployee()</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        List&lt;Employee&gt; list=new ArrayList&lt;Employee&gt;();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        for(int i=0;i&lt;30;i++)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            Employee emp=new Employee();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            emp.setId(&quot;总公司&quot;+i);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            list.add(emp);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        return list;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    public void printAllEmployee(SubEmployee sub)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        sub.printEmployee();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        List&lt;Employee&gt; list2=this,getAllEmployee();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        for(Employee e:list2)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            System.out.println(e.getId());</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div></div><div><span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">修改后，为分公司增加了打印人员ID的方法，总公司直接调用来打印，从而避免了与分公司的员工发生耦合。</span></div></span>
</div></body></html> 